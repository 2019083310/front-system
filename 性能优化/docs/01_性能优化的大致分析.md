# 性能优化的大致分析

## 1-从输入url角度看待性能优化

​	当我们在浏览器输入一个url之后，会经过以下这几个流程：

​	本地缓存-->dns解析-->tcp三次握手-->发送http请求-->服务器处理数据-->浏览器拿到数据开始渲染页面

​	那我们可以分析出来其实大致分为三个过程:首先浏览器发送请求阶段，接着服务器处理数据阶段，最后浏览器渲染页面。

​	从浏览器输入一个url之后，发送请求阶段大致耗费时间的过程为:本地缓存、dns解析、http请求

​	从本地缓存角度上我们可以通过设置cache-control，expries字段来设置强缓存，通过If-None-Match/If-Modify-Since字段来设置协商缓存。从DNS解析的角度我们也可以通过DNS服务器来设置本地dns缓存时间。

http请求的耗费主要是因为http的队头阻塞、可以通过开启一个域名支持六个tcp连接，除此之外还可以通过域名切片的方式变为36个tcp连接，最根本的解决方案是通过http2.0的多路复用来解决。

​	从服务器处理的角度上来看，主要原因是服务器需要对数据进行处理，从数据库中取数据，然后返回数据，那么返回的js,css文件可能是非常大的，我们可以通过gzip压缩的方式加快文件的传输速度。其次，还有我们服务器的缓存，我们可以通过cdn在全国部署一些cdn缓存节点，从而加快响应速度。还有处理重定向的时候(服务端302或者window.location),那么重定向会造成dns，tcp连接，http请求这个过程再来一遍，因此要合理的设置重定向。

​	从浏览器最后渲染的角度上来看，主要分为DOM解析、CSSOM树的解析和布局渲染书，以及页面的重回重排。

​	DOM解析是非常重要的，如果DOM树节点非常多，或者遇到script标签都会阻塞DOM解析，因此可以通过defer/async异步加载js,放在底部。对于页面的重回重排来讲，任何一次重排都会让我们的页面重新渲染一次，可见对于加载性能是非常不友好的，因此要尽量减少页面的重回重排。

​	除了以上这些方面，还包括硬件方面GPU图层，GUI渲染等，还有网络层、应用层的慢启动，拥塞避免算法等，还包括页面解析渲染的算法等等。

## 2-从一个项目的角度看待性能优化